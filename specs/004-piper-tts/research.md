# Research: Piper TTS support

## Findings

### Decision: Использовать локальные модели Piper с авто-скачиванием при старте
- Rationale: Соответствует требованию оффлайн работы и контролю версий; упрощает деплой без внешних API зависимостей.
- Alternatives considered: A) Запрашивать удалённый Piper endpoint — отклонено (нет внешнего сервиса, риск задержек); B) Ручная загрузка весов перед запуском — отклонено (больше ручных шагов, нет автоконтроля целостности).

### Decision: Проверять checksum и размер весов перед использованием
- Rationale: Требование из спека; защищает от повреждённых или подменённых файлов и обеспечивает предсказуемый старт.
- Alternatives considered: A) Полагаться на размер/mtime — отклонено (низкая надёжность); B) Пропускать проверки — отклонено (риск невалидных весов и сбоев).

### Decision: Целевой p95 синтеза ≤5 секунд для текста ≤1000 символов на CPU
- Rationale: Соответствует success criteria; ориентир для параметров модели и длины входа.
- Alternatives considered: A) Снизить до 3 секунд — отклонено (может потребовать ускорителей/GPU); B) Без метрики — отклонено (нет проверяемой цели).

### Decision: Поддерживать выбор русской голосовой модели Piper по конфигу
- Rationale: Бот работает на русском; выбор модели должен быть явным и валидируемым.
- Alternatives considered: A) Жёстко зашить модель по умолчанию — отклонено (нет гибкости, нарушает требование явного указания модели); B) Авто-подбор по языку текста — отклонено (дополнительная логика, выход за рамки).

